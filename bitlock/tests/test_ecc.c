#include "secp256k1/sb_sw_curves.h"
#include "secp256k1/sb_sw_lib.h"


void test_sign_k256(void)
{
    static const sb_sw_message_digest_t m = {
        {
            0x4B, 0x68, 0x8D, 0xF4, 0x0B, 0xCE, 0xDB, 0xE6,
            0x41, 0xDD, 0xB1, 0x6F, 0xF0, 0xA1, 0x84, 0x2D,
            0x9C, 0x67, 0xEA, 0x1C, 0x3B, 0xF6, 0x3F, 0x3E,
            0x04, 0x71, 0xBA, 0xA6, 0x64, 0x53, 0x1D, 0x1A
        }};
    static const sb_sw_private_t d = {
        {
            0xEB, 0xB2, 0xC0, 0x82, 0xFD, 0x77, 0x27, 0x89,
            0x0A, 0x28, 0xAC, 0x82, 0xF6, 0xBD, 0xF9, 0x7B,
            0xAD, 0x8D, 0xE9, 0xF5, 0xD7, 0xC9, 0x02, 0x86,
            0x92, 0xDE, 0x1A, 0x25, 0x5C, 0xAD, 0x3E, 0x0F
        }};
    static const sb_sw_public_t p = {
        {
            0x77, 0x9D, 0xD1, 0x97, 0xA5, 0xDF, 0x97, 0x7E,
            0xD2, 0xCF, 0x6C, 0xB3, 0x1D, 0x82, 0xD4, 0x33,
            0x28, 0xB7, 0x90, 0xDC, 0x6B, 0x3B, 0x7D, 0x44,
            0x37, 0xA4, 0x27, 0xBD, 0x58, 0x47, 0xDF, 0xCD,
            0xE9, 0x4B, 0x72, 0x4A, 0x55, 0x5B, 0x6D, 0x01,
            0x7B, 0xB7, 0x60, 0x7C, 0x3E, 0x32, 0x81, 0xDA,
            0xF5, 0xB1, 0x69, 0x9D, 0x6E, 0xF4, 0x12, 0x49,
            0x75, 0xC9, 0x23, 0x7B, 0x91, 0x7D, 0x42, 0x6F
        }};

    sb_sw_signature_t out;
    sb_sw_public_t pub_out;
    sb_sw_context_t ct;
    assert(sb_sw_valid_public_key(&ct, &p, SB_SW_CURVE_SECP256K1,
                                  SB_DATA_ENDIAN_BIG) == 1);
								  
    assert(sb_sw_compute_public_key(&ct, &pub_out, &d, NULL,
                                    SB_SW_CURVE_SECP256K1,
                                    SB_DATA_ENDIAN_BIG) == 1);
    assert(memcmp(&pub_out, &p, sizeof(p)) == 0);
    assert(sb_sw_sign_message_digest(&ct, &out, &d, &m, NULL,
                                     SB_SW_CURVE_SECP256K1,
                                     SB_DATA_ENDIAN_BIG) == 1);
    assert(sb_sw_verify_signature(&ct, &out, &p, &m, NULL,
                                  SB_SW_CURVE_SECP256K1,
                                  SB_DATA_ENDIAN_BIG) == 1);
}

